{
    "0": [
        "\npackage org.biojava.nbio.aaproperties;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.nio.CharBuffer;\nimport java.util.HashSet;\nimport java.util.Set;\n\n\npublic class Utils {\n\n\tprivate final static Logger logger = LoggerFactory.getLogger(Utils.class);\n\n\t\n\tpublic final static double roundToDecimals(double d, int c) {\n\t\tif(c < 0) return d;\n\t\tdouble p = Math.pow(10,c);\n\t\td = d * p;\n\t\tdouble tmp = Math.round(d);\n\t\treturn tmp/p;\n\t}\n\n\t\n\tpublic final static boolean doesSequenceContainInvalidChar(String sequence, Set<Character> cSet){\n\t\t\t\tfor(char c:sequence.toCharArray()){\n\t\t\t\t\tif(!cSet.contains(c)) return true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t}\n\n\t\n\tpublic final static int getNumberOfInvalidChar(String sequence,  Set<Character> cSet, boolean ignoreCase){\n\t\tchar[] cArray = ignoreCase ? sequence.toUpperCase().toCharArray(): sequence.toCharArray();\n\t\tfinal Set<Character> characterSet = cSet == null ?PeptideProperties.standardAASet: cSet ; \n\t\tint total = (int)CharBuffer.wrap(cArray).chars().filter(character -> !characterSet.contains((char)character)).count();\n\t\treturn total;\n\t}\n\n\t\n\tpublic final static String cleanSequence(String sequence, Set<Character> cSet){\n\t\tSet<Character> invalidCharSet = new HashSet<Character>();\n\t\tStringBuilder cleanSeq = new StringBuilder();\n\t\tif(cSet == null) cSet = PeptideProperties.standardAASet;\n\t\tfor(char c:sequence.toCharArray()){\n\t\t\tif(!cSet.contains(c)){\n\t\t\t\tcleanSeq.append(\"-\");\n\t\t\t\tinvalidCharSet.add(c);\n\t\t\t}else{\n\t\t\t\tcleanSeq.append(c);\n\t\t\t}\n\t\t}\n\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\n\t\treturn cleanSeq.toString();\n\t}\n\n\t\n\tpublic static final String checkSequence(String sequence){\n\t\treturn checkSequence(sequence, null);\n\t}\n\n\t\n\tpublic static final String checkSequence(String sequence, Set<Character> cSet){\n\t\tboolean containInvalid = false;\n\t\tif(cSet != null){\n\t\t\tcontainInvalid = sequence != null && doesSequenceContainInvalidChar(sequence, cSet);\n\t\t}else{\n\t\t\tcontainInvalid = sequence != null && doesSequenceContainInvalidChar(sequence, PeptideProperties.standardAASet);\n\t\t}\n\t\tif(containInvalid){\n\t\t\tString cSeq = cleanSequence(sequence, cSet);\n\t\t\t\n\t\t\t\n\t\t\treturn cSeq;\n\t\t}\n\t\telse{\n\t\t\treturn sequence;\n\t\t}\n\t}\n}\n"
    ],
    "1": [
        "package org.biojava.nbio.aaproperties;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.Set;\n\npublic class Utils {\n    private static final Logger logger = LoggerFactory.getLogger(Utils.class);\n\n    public static final double roundToDecimals(double d, int c) {\n        if (c < 0) return d;\n        double p = Math.pow(10, c);\n        return Math.round(d * p) / p;\n    }\n\n    public static final boolean doesSequenceContainInvalidChar(String sequence, Set<Character> cSet) {\n        int len = sequence.length();\n        for (int i = 0; i < len; ++i) {\n            if (!cSet.contains(sequence.charAt(i))) return true;\n        }\n        return false;\n    }\n\n    public static final int getNumberOfInvalidChar(String sequence, Set<Character> cSet, boolean ignoreCase) {\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        int count = 0;\n        int len = sequence.length();\n        for (int i = 0; i < len; ++i) {\n            char c = sequence.charAt(i);\n            if (ignoreCase) c = Character.toUpperCase(c);\n            if (!cSet.contains(c)) count++;\n        }\n        return count;\n    }\n\n    public static final String cleanSequence(String sequence, Set<Character> cSet) {\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        int len = sequence.length();\n        StringBuilder cleanSeq = new StringBuilder(len);\n        for (int i = 0; i < len; ++i) {\n            char c = sequence.charAt(i);\n            if (!cSet.contains(c)) {\n                cleanSeq.append('-');\n            } else {\n                cleanSeq.append(c);\n            }\n        }\n        return cleanSeq.toString();\n    }\n\n    public static final String checkSequence(String sequence) {\n        return checkSequence(sequence, null);\n    }\n\n    public static final String checkSequence(String sequence, Set<Character> cSet) {\n        if (sequence == null) return null;\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        if (doesSequenceContainInvalidChar(sequence, cSet)) {\n            return cleanSequence(sequence, cSet);\n        } else {\n            return sequence;\n        }\n    }\n}\n"
    ],
    "2": [
        "package org.biojava.nbio.aaproperties;\n\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\n\nimport java.util.BitSet;\nimport java.util.Set;\n\npublic class Utils {\n    private static final Logger logger = LoggerFactory.getLogger(Utils.class);\n\n    \n    private static BitSet toBitSet(Set<Character> cSet) {\n        BitSet bs = new BitSet(256);\n        for (Character c : cSet) {\n            bs.set((int) c);\n        }\n        return bs;\n    }\n\n    public static final double roundToDecimals(double d, int c) {\n        if (c < 0) return d;\n        double p = Math.pow(10, c);\n        return Math.round(d * p) / p;\n    }\n\n    \n    private static boolean doesSequenceContainInvalidChar(String sequence, BitSet validChars) {\n        int len = sequence.length();\n        for (int i = 0; i < len; ++i) {\n            if (!validChars.get(sequence.charAt(i))) return true;\n        }\n        return false;\n    }\n\n    public static final boolean doesSequenceContainInvalidChar(String sequence, Set<Character> cSet) {\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        return doesSequenceContainInvalidChar(sequence, toBitSet(cSet));\n    }\n\n    public static final int getNumberOfInvalidChar(String sequence, Set<Character> cSet, boolean ignoreCase) {\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        BitSet validChars = toBitSet(cSet);\n        int count = 0;\n        int len = sequence.length();\n        for (int i = 0; i < len; ++i) {\n            char c = sequence.charAt(i);\n            if (ignoreCase) c = Character.toUpperCase(c);\n            if (!validChars.get(c)) count++;\n        }\n        return count;\n    }\n\n    public static final String cleanSequence(String sequence, Set<Character> cSet) {\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        BitSet validChars = toBitSet(cSet);\n        int len = sequence.length();\n        StringBuilder cleanSeq = new StringBuilder(len);\n        for (int i = 0; i < len; ++i) {\n            char c = sequence.charAt(i);\n            if (!validChars.get(c)) {\n                cleanSeq.append('-');\n            } else {\n                cleanSeq.append(c);\n            }\n        }\n        return cleanSeq.toString();\n    }\n\n    \n    public static final String checkSequence(String sequence) {\n        return checkSequence(sequence, null);\n    }\n\n    public static final String checkSequence(String sequence, Set<Character> cSet) {\n        if (sequence == null) return null;\n        if (cSet == null) cSet = PeptideProperties.standardAASet;\n        BitSet validChars = toBitSet(cSet);\n        int len = sequence.length();\n        StringBuilder cleanSeq = null;\n        for (int i = 0; i < len; ++i) {\n            char c = sequence.charAt(i);\n            if (!validChars.get(c)) {\n                if (cleanSeq == null) {\n                    cleanSeq = new StringBuilder(sequence.substring(0, i));\n                }\n                cleanSeq.append('-');\n            } else if (cleanSeq != null) {\n                cleanSeq.append(c);\n            }\n        }\n        return cleanSeq == null ? sequence : cleanSeq.toString();\n    }\n}\n"
    ]
}